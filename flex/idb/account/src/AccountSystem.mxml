<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" xmlns:mx="library://ns.adobe.com/flex/mx" xmlns:services="com.artogrid.services.*" minWidth="955" minHeight="600"
			   xmlns:ui="com.artogrid.accountsystem.ui.*" preinitialize="InitData.init();">
	<fx:Script>
		<![CDATA[
			import com.artogrid.accountsystem.bl.InitData;
			import com.artogrid.accountsystem.vo.AccountDTO;

			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			import mx.rpc.events.ResultEvent;

			import spark.events.GridSelectionEvent;

			protected function accountlist1_creationCompleteHandler(event:FlexEvent):void {
				accountList.addEventListener(GridSelectionEvent.SELECTION_CHANGE, listSelectionChange);
				accountEditFrom.addEventListener("add_new_account_to_list", addNewAccountToListHandler);
			}

			private function addNewAccountToListHandler(event:Event):void {
				accountList.dataGrid.dataProvider.addItemAt(accountEditFrom.accountDTO,0);
				accountList.dataGrid.selectedItem=accountEditFrom.accountDTO;
				accountList.dataGrid.scroller.verticalScrollBar.value=accountList.dataGrid.scroller.verticalScrollBar.minimum;
			}

			private function listSelectionChange(event:GridSelectionEvent):void {
				var accounts:ArrayCollection=accountList.getDatas()
				var rowIndex:int=event.selectionChange.rowIndex;
				if (rowIndex != -1) {
					var account:AccountDTO=accounts.getItemAt(rowIndex) as AccountDTO;
					accountEditFrom.accountDTO=account;
				}
			}
		]]>
	</fx:Script>
	<s:VGroup left="10" right="10" top="100" bottom="10">
		<ui:AccountList id="accountList" width="100%" height="100%" creationComplete="accountlist1_creationCompleteHandler(event)">
		</ui:AccountList>
		<ui:AccountEditFrom id="accountEditFrom" width="100%">
		</ui:AccountEditFrom>
	</s:VGroup>
</s:Application>
